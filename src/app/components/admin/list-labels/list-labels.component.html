<div class="grid">
    <div class="col-12 p-0">
        <div class="card admin-content m-0">
            <!-- Start: Breakcrum Page list-labels -->
            <p-breadcrumb [model]="breadcrumbItem" [home]="breadcrumbHome" styleClass="breadcrumb-admin"></p-breadcrumb>
            <!-- End: Breakcrum Page list-labels -->

            <div class="my-2 flex justify-content-between flex-wrap">
                <span class="block p-input-icon-left">
                    <i class="pi pi-search"></i>
                    <input pInputText type="text" placeholder="Tìm kiếm ..." class="inline-block lg:w-17rem sm:w-auto p-inputtext-sm" [(ngModel)]="searchData.keyword" (keydown.enter)="search()" />
                    <button pButton pRipple icon="pi pi-search" class="p-button-primary mr-2 ml-2 p-button-sm" (click)="search()"></button>
                    <button pButton pRipple icon="pi pi-times" class="p-button-secondary p-button-sm" (click)="resetSearch()"></button>
                </span>
                <div class="flex justify-content-end flex-wrap">
                    <button pButton pRipple label="Thêm mới" icon="pi pi-plus" class="p-button-success p-button-sm"
                        (click)="onCreateItem()"></button>
                </div>
            </div>

            <m-table [isLazyLoad]="false" [cols]="cols" [items]="listLabels" (selectRow)="selectLabel($event)" class="table-admin"
                [customBodyTemplate]="customBodyTemplate" [customHeaderTemplate]="customHeaderTemplate" [calcHeight]="303"
                [dataKey]="'id'" [loading]="loading" class="table-admin">
            </m-table>
            <ng-template #customHeaderTemplate>
                <th *ngFor="let col of cols; let i = index" [style.minWidth]="col['width']" class= '{{ col.isOpSort? "cursor-pointer" : ""}}' (click)="customSort(col)">
                    {{ col["header"] }}
                    <div class="ml-1">
                        <i class='{{ col.isOpSort? (col.iconSort == 0? "pi pi-sort-alt" : (col.iconSort == 1? "pi pi-sort-amount-up-alt" : "pi pi-sort-amount-down")) : ""}}' style="font-size: 1.01rem"></i>
                    </div>
                </th>
                <th style="min-width: 8rem" pFrozenColumn alignFrozen="right" class= '{{ colColor.isOpSort? "cursor-pointer" : ""}}' (click)="customSort(this.colColor)">
                    {{this.colColor.header}}
                    <div class="ml-1">
                        <i class='{{ colColor.isOpSort? (colColor.iconSort == 0? "pi pi-sort-alt" : (colColor.iconSort == 1? "pi pi-sort-amount-up-alt" : "pi pi-sort-amount-down")) : ""}}' style="font-size: 1.01rem"></i>
                    </div>
                </th>
                <th style="min-width: 6rem" class="text-center" pFrozenColumn alignFrozen="right" class= '{{ colDisable.isOpSort? "cursor-pointer" : ""}}' (click)="customSort(this.colDisable)">
                    {{this.colDisable.header}}
                    <div class="ml-1">
                        <i class='{{ colDisable.isOpSort? (colDisable.iconSort == 0? "pi pi-sort-alt" : (colDisable.iconSort == 1? "pi pi-sort-amount-up-alt" : "pi pi-sort-amount-down")) : ""}}' style="font-size: 1.01rem"></i>
                    </div>
                </th>
                <th style="min-width: 6rem" pFrozenColumn alignFrozen="right"></th>
            </ng-template>
            <ng-template #customBodyTemplate let-rowData>
                <td [style.minWidth]="col.width" *ngFor="let col of cols">
                    {{ rowData[col["field"]] }}
                </td>
                <td [style.minWidth]="'8rem'" pFrozenColumn alignFrozen="right">
                    <p-chip label="{{rowData.color}}" icon="pi pi-bookmark" styleClass=" custom-chip" [style]="{ 'border-color':rowData.color }"></p-chip>
                </td>
                <td class="text-center" [style.minWidth]="'6rem'" pFrozenColumn alignFrozen="right">
                    <p-inputSwitch [(ngModel)]="!rowData.disable" (onChange)="toggle(rowData)"></p-inputSwitch>
                </td>
                <td [style.minWidth]="'6rem'" class="text-center flex justify-content-center " pFrozenColumn alignFrozen="right">
                    <button pButton pRipple icon="pi pi-pencil" class="p-button-rounded p-button-success p-button-xs  mr-2"
                        (click)="onEditItem(rowData)"></button>
                    <button pButton pRipple icon="pi pi-trash" class="p-button-rounded p-button-warning p-button-xs" (click)="onDeleteItem(rowData)"></button>
                </td>
            </ng-template>
        </div>

        <p-dialog [(visible)]="isVisibleLabelDialog" [style]="{ width: '450px' }" [header]="listLabelDialogHeader"
            [modal]="true" class="p-fluid">
            <ng-template pTemplate="content">
                <form [formGroup]="labelForm">
                    <div class="field">
                        <label for="name"><span class="text-red-500">*</span>Tên nhãn</label>
                        <input type="text" pInputText id="name" formControlName="name" required autofocus />
                        <div class="m-error" *ngIf="
                                labelForm.controls['name'].invalid &&
                                labelForm.controls['name'].dirty
                            ">
                            *Tên nhãn không được để trống
                        </div>
                    </div>
                    <div class="field">
                        <label for="color"><span class="text-red-500">*</span>Màu nhãn</label>
                        <input type="color" formControlName="color" id="color" required class="ml-5" />
                        <!-- <p-colorPicker formControlName="color"  [baseZIndex]="10000000" appendTo="body"></p-colorPicker>
              <p-colorPicker [(ngModel)]="color2" [inline]="true"></p-colorPicker> -->
                        <!-- <textarea id="color" pInputText formControlName="color" rows="3"></textarea> -->
                        <div class="m-error" *ngIf="
                                labelForm.controls['color'].invalid &&
                                labelForm.controls['color'].dirty
                            ">
                            *Màu nhãn không được để trống
                        </div>
                    </div>
                    <div class="field">
                        <label for="priority"><span></span>Độ ưu tiên</label>
                        <textarea id="priority" pInputTextarea formControlName="priority" rows="3" [autoResize]="true"></textarea>
                        <div class="m-error" *ngIf="
                                labelForm.controls['priority'].invalid &&
                                labelForm.controls['priority'].dirty
                            ">
                            *Độ ưu tiên không được để trống
                        </div>
                    </div>
                </form>
            </ng-template>

            <ng-template pTemplate="footer">
                <button pButton pRipple label="Đóng" icon="pi pi-times" class="p-button-text text-red-600"
                    (click)="isVisibleLabelDialog = false"></button>
                <button pButton pRipple label="Lưu" icon="pi pi-check" class="p-button-text" (click)="saveItem()"></button>
            </ng-template>
        </p-dialog>
    </div>
</div>

<confirm-dialog [(visible)]="isVisibleDeleteItemDialog" [confirmText]="textConfirmDelete"
    (onConfirm)="deleteLabel()"></confirm-dialog>
